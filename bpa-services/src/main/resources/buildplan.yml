serviceMaps:
 serviceName: bpa-services
 mappings:
 - version: 1.0
   description: Persists buildingplan details in EG_BPA_BuildingPlan  table
   fromTopic: save-bpa-buildingplan
   isTransaction: true
   queryMaps:

       - query: INSERT INTO eg_bpa_buildingplan(id, applicationno, edcrnumber, tenantid, servicetype, status, ownershipcategory, additionaldetails, createdby, lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?); 
         basePath: BPA
         jsonMaps:
          - jsonPath: $.BPA.id

          - jsonPath: $.BPA.applicationNo

          - jsonPath: $.BPA.edcrNumber

          - jsonPath: $.BPA.tenantId

          - jsonPath: $.BPA.serviceType

          - jsonPath: $.BPA.status

          - jsonPath: $.BPA.ownershipCategory

          - jsonPath: $.BPA.additionalDetails
            type: JSON
            dbType: JSONB

          - jsonPath: $.BPA.auditDetails.createdBy

          - jsonPath: $.BPA.auditDetails.lastModifiedBy

          - jsonPath: $.BPA.auditDetails.createdTime

          - jsonPath: $.BPA.auditDetails.lastModifiedTime


       - query: INSERT INTO eg_bpa_document( id, documenttype, filestore, buildingplanid, documentuid, createdby, lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: BPA.documents.*
         jsonMaps:
          - jsonPath: $.BPA.documents.*.id

          - jsonPath: $.BPA.documents.*.documentType

          - jsonPath: $.BPA.documents.*.fileStore

          - jsonPath: $.BPA.id

          - jsonPath: $.BPA.documents.*.documentuid

          - jsonPath: $.BPA.documents.*.auditDetails.createdBy

          - jsonPath: $.BPA.documents.*..auditDetails.lastModifiedBy

          - jsonPath: $.BPA.documents.*.auditDetails.createdTime

          - jsonPath: $.BPA.documents.*.auditDetails.lastModifiedTime


       - query: INSERT INTO eg_bpa_address( id, tenantid, doorno, plotno, district, region, state, country, pincode, additiondetails, buildingname, locality, landmark, city, buildingplanid, createdby, lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: BPA.address
         jsonMaps:
          - jsonPath: $.BPA.address.id

          - jsonPath: $.BPA.address.tenantId

          - jsonPath: $.BPA.address.doorNo

          - jsonPath: $.BPA.address.plotNo

          - jsonPath: $.BPA.address.district

          - jsonPath: $.BPA.address.region

          - jsonPath: $.BPA.address.state

          - jsonPath: $.BPA.address.country
          
          - jsonPath: $.BPA.address.pincode

          - jsonPath: $.BPA.address.additionDetails
          
          - jsonPath: $.BPA.address.buildingName
          
          - jsonPath: $.BPA.address.locality.code

          - jsonPath: $.BPA.address.landmark

          - jsonPath: $.BPA.address.city

          - jsonPath: $.BPA.id

          - jsonPath: $.BPA.auditDetails.createdBy

          - jsonPath: $.BPA.auditDetails.lastModifiedBy

          - jsonPath: $.BPA.auditDetails.createdTime

          - jsonPath: $.BPA.auditDetails.lastModifiedTime

       - query: INSERT INTO eg_bpa_owner( id, name, mobilenumber, gender, fatherorhusbandname, correspondenceaddress, institutionid, isprimaryowner, ownertype, ownershippercentage, relationship, buildingplanid, createdby,lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: BPA.owners.*
         jsonMaps:
          - jsonPath: $.BPA.owners.*.id

          - jsonPath: $.BPA.owners.*.name

          - jsonPath: $.BPA.owners.*.mobileNumber

          - jsonPath: $.BPA.owners.*.gender

          - jsonPath: $.BPA.owners.*.fatherOrHusbandName

          - jsonPath: $.BPA.owners.*.correspondenceAddress

          - jsonPath: $.BPA.owners.*.institutionId

          - jsonPath: $.BPA.owners.*.isPrimaryOwner

          - jsonPath: $.BPA.owners.*.ownerType

          - jsonPath: $.BPA.owners.*.ownerShipPercentage

          - jsonPath: $.BPA.owners.*.relationship

          - jsonPath: $.BPA.id

          - jsonPath: $.BPA.owners.*.auditDetails.createdBy

          - jsonPath: $.BPA.owners.*.auditDetails.lastModifiedBy

          - jsonPath: $.BPA.owners.*.auditDetails.createdTime

          - jsonPath: $.BPA.owners.*.auditDetails.lastModifiedTime


       - query: INSERT INTO eg_bpa_unit( id,tenantid, usageCategory, buildingplanid, additionaldetails, createdby,lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: BPA.units.*
         jsonMaps:
          - jsonPath: $.BPA.units.*.id

          - jsonPath: $.BPA.units.*.tenantId

          - jsonPath: $.BPA.units.*.usageCategoryowners

          - jsonPath: $.BPA.id

          - jsonPath: $.BPA.units.*.additionalDetails
            type: JSON
            dbType: JSONB

          - jsonPath: $.BPA.units.*.auditDetails.createdBy

          - jsonPath: $.BPA.units.*.auditDetails.lastModifiedBy

          - jsonPath: $.BPA.units.*.auditDetails.createdTime

          - jsonPath: $.BPA.units.*.auditDetails.lastModifiedTime
  

       - query: INSERT INTO eg_bpa_geolocation( latitude, longitude, additionaldetails, addressid, createdby,lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?);
         basePath: BPA.address.geoLocation
         jsonMaps:
          - jsonPath: $.BPA.address.geoLocation.latitude
            type: DOUBLE
            dbType: DOUBLE

          - jsonPath: $.BPA.address.geoLocation.longitude
            type: DOUBLE
            dbType: DOUBLE

          - jsonPath: $.BPA.address.geoLocation.additionalDetails
            type: JSON
            dbType: JSONB

          - jsonPath: $.BPA.address.id

          - jsonPath: $.BPA.auditDetails.createdBy

          - jsonPath: $.BPA.auditDetails.lastModifiedBy

          - jsonPath: $.BPA.auditDetails.createdTime

          - jsonPath: $.BPA.auditDetails.lastModifiedTime
  



